/*
 * XenForo form.min.js
 * Copyright 2010-2018 XenForo Ltd.
 * Released under the XenForo License Agreement: https://xenforo.com/license-agreement
 */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,h,e){c instanceof String&&(c=String(c));for(var a=c.length,b=0;b<a;b++){var f=c[b];if(h.call(e,f,b,c))return{i:b,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,h,e){c!=Array.prototype&&c!=Object.prototype&&(c[h]=e.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,h,e,a){if(h){e=$jscomp.global;c=c.split(".");for(a=0;a<c.length-1;a++){var b=c[a];b in e||(e[b]={});e=e[b]}c=c[c.length-1];a=e[c];h=h(a);h!=a&&null!=h&&$jscomp.defineProperty(e,c,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(c,e){return $jscomp.findInternal(this,c,e).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(c){var h=0;return $jscomp.iteratorPrototype(function(){return h<c.length?{done:!1,value:c[h++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};$jscomp.iteratorFromArray=function(c,h){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var e=0,a={next:function(){if(e<c.length){var b=e++;return{value:h(b,c[b]),done:!1}}a.next=function(){return{done:!0,value:void 0}};return a.next()}};a[Symbol.iterator]=function(){return a};return a};
$jscomp.polyfill("Array.prototype.values",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(c,e){return e})}},"es6","es3");
!function(c,h,e){XF.SubmitClick=XF.Click.newHandler({eventNameSpace:"XFSubmitClick",options:{target:null,container:null,timeout:500,uncheckedValue:"0",disable:null},$input:null,$form:null,init:function(){var a=this.$target;if(a.is("label")&&(a=a.find("input:radio, input:checkbox"),!a.length))return;this.$input=a;a=a.closest("form");this.$form=a.length?a:null},click:function(a){var b=this.$input,c=this.$form,d=this.options.target,k=this.options.container;if(b)if(d){var g=this.options.uncheckedValue;
setTimeout(function(){var a={};k?a=b.closest(k).find("input, select, textarea").serializeArray():a[b.attr("name")]=b.prop("checked")?b.attr("value"):g;XF.ajax("POST",d,a)},0)}else c?((a=c.data("submit-click-timer"))&&clearTimeout(a),c.one("ajax-submit:complete",function(a,c,f){if(c.errors)b.prop("checked",b.prop("checked")?"":"checked");else if("checkbox"==b.attr("type")&&null!==b.closest("tr.dataList-row"))b.closest("tr.dataList-row")[b.prop("checked")?"removeClass":"addClass"]("dataList-row--disabled")}),
a=setTimeout(function(){c.submit()},this.options.timeout),c.data("submit-click-timer",a)):console.error("No target or form to submit on click")}});XF.AjaxSubmit=XF.Element.newHandler({options:{redirect:!0,skipOverlayRedirect:!1,forceFlashMessage:!1,resetComplete:!1,hideOverlay:!0,disableSubmit:".button, :submit, :reset, [data-disable-submit]",jsonName:null,jsonOptIn:null,replace:null},submitPending:!1,$submitButton:null,init:function(){var a=this.$target;a.is("form")?(a.on({submit:XF.proxy(this,"submit"),
keyup:XF.proxy(this,"cmdEnterKey"),"draft:beforesave":XF.proxy(this,"draftCheck")}),a.on("click","input[type=submit], button:not([type]), button[type=submit]",XF.proxy(this,"submitButtonClicked"))):console.error("%o is not a form",a[0])},submit:function(a){var b=this.$submitButton,f=this.$target;if("multipart/form-data"==f.attr("enctype")){if(this.options.jsonName){a.preventDefault();console.error("JSON serialized forms do not support the file upload-style enctype.");XF.alert(XF.phrase("oops_we_ran_into_some_problems_more_details_console"));
return}if(!h.FormData)return}if(!this.$submitButton||!this.$submitButton.data("prevent-ajax"))if(this.submitPending)a&&a.preventDefault();else{var d=c.Event("ajax-submit:before"),k={form:f,handler:this,method:f.attr("method")||"get",action:f.attr("action"),submitButton:b,preventSubmit:!1,successCallback:XF.proxy(this,"submitResponse"),ajaxOptions:{skipDefault:!0}};f.trigger(d,k);if(k.preventSubmit)return!1;if(d.isDefaultPrevented())return!0;a&&a.preventDefault();var g=this;setTimeout(function(){g.submitPending=
!0;var a=XF.getDefaultFormData(f,b,g.options.jsonName,g.options.jsonOptIn);g.disableButtons();XF.ajax(k.method,k.action,a,k.successCallback,k.ajaxOptions).always(function(){g.$submitButton=null;setTimeout(function(){g.submitPending=!1;g.enableButtons()},300);d=c.Event("ajax-submit:always");f.trigger(d,f,g)})},0)}},disableButtons:function(){var a=this.options.disableSubmit;a&&this.$target.find(a).prop("disabled",!0)},enableButtons:function(){var a=this.options.disableSubmit;a&&this.$target.find(a).prop("disabled",
!1)},submitResponse:function(a,b,f){if("object"!=typeof a)XF.alert("Response was not JSON.");else{b=this.$target;f=this.$submitButton;var d=c.Event("ajax-submit:response");b.trigger(d,a,this);if(!d.isDefaultPrevented()){d=c.Event("ajax-submit:error");var k=!1,g=a.redirect&&this.options.redirect,e=b.closest(".overlay");e.length&&this.options.hideOverlay||(e=null);g&&this.options.skipOverlayRedirect&&e&&(g=!1);f&&f.attr("data-ajax-redirect")&&(g=f.data("ajax-redirect"));if(a.errorHtml)b.trigger(d,a,
this),d.isDefaultPrevented()||XF.setupHtmlInsert(a.errorHtml,function(a,b){b=b.h1||b.title||XF.phrase("oops_we_ran_into_some_problems");XF.overlayMessage(b,a)}),k=!0;else if(a.errors)b.trigger(d,a,this),d.isDefaultPrevented()||XF.alert(a.errors),k=!0;else if(a.exception)XF.alert(a.exception);else if("ok"==a.status&&a.message)g?this.options.forceFlashMessage?XF.flashMessage(a.message,1E3,function(){XF.redirect(a.redirect)}):XF.redirect(a.redirect):XF.flashMessage(a.message,3E3),e&&e.trigger("overlay:hide");
else if(a.html){var h=this;XF.setupHtmlInsert(a.html,function(a,b,c){if(h.options.replace&&h.doSubmitReplace(a,c))return!1;e&&e.trigger("overlay:hide");a=XF.getOverlayHtml({html:a,title:b.h1||b.title});XF.showOverlay(a)})}else"ok"==a.status&&(g&&XF.redirect(a.redirect),e&&e.trigger("overlay:hide"));a.errors&&d.isDefaultPrevented();d=c.Event("ajax-submit:complete");b.trigger(d,a,this);d.isDefaultPrevented()||this.options.resetComplete&&!k&&b[0].reset()}}},doSubmitReplace:function(a,b){var f=this.options.replace;
if(!f)return!1;var d=f.split(" with ");f=c.trim(d[0]);d=d[1]?c.trim(d[1]):f;if("self"==f||this.$target.is(f))var e=this.$target;else e=this.$target.find(f).first(),e.length||(e=c(f).first());if(!e.length)return console.error("Could not find old selector '"+f+"'"),!1;var g=a.is(d)?a:a.find(d).first();if(!g.length)return console.error("Could not find new selector '"+d+"'"),!1;g.hide().insertAfter(e);e.xfFadeUp(null,function(){e.remove();g.length&&(XF.activate(g),b(!1));g.xfFadeDown(null,XF.layoutChange)});
return!0},submitButtonClicked:function(a){this.$submitButton=c(a.currentTarget)},draftCheck:function(a){this.submitPending&&a.preventDefault()}});XF.AutoComplete=XF.Element.newHandler({loadTimer:null,loadVal:"",results:null,options:{single:!1,multiple:",",acurl:"",minLength:2,queryKey:"q",extraFields:"",extraParams:{},jsonContainer:"results",autosubmit:!1},init:function(){var a=this.$target;this.options.autosubmit&&(this.options.single=!0);this.options.acurl||(this.options.acurl=XF.getAutoCompleteUrl());
this.results=new XF.AutoCompleteResults({onInsert:XF.proxy(this,"addValue")});a.attr("autocomplete","off").on({keydown:XF.proxy(this,"keydown"),keyup:XF.proxy(this,"keyup"),"blur click":XF.proxy(this,"blur"),paste:function(){setTimeout(function(){a.trigger("keydown")},0)}});a.closest("form").submit(XF.proxy(this,"hideResults"))},keydown:function(a){if(this.results.isVisible()){var b=this.results,c=function(){a.preventDefault();return!1};switch(a.which){case 40:return b.selectResult(1),c();case 38:return b.selectResult(-1),
c();case 27:return this.hide(),c();case 13:return b.insertSelectedResult(),c()}}},keyup:function(a){if(this.results.isVisible())switch(a.which){case 40:case 38:case 13:return}this.hideResults();this.loadTimer&&clearTimeout(this.loadTimer);this.loadTimer=setTimeout(XF.proxy(this,"load"),200)},blur:function(a){clearTimeout(this.loadTimer);setTimeout(XF.proxy(this,"hideResults"),250);this.xhr&&(this.xhr.abort(),this.xhr=!1)},load:function(){var a=this.loadVal,b=this.options.extraParams;this.loadTimer&&
clearTimeout(this.loadTimer);this.loadVal=this.getPartialValue();""==this.loadVal?this.hideResults():this.loadVal==a||this.loadVal.length<this.options.minLength||(b[this.options.queryKey]=this.loadVal,""!=this.options.extraFields&&c(this.options.extraFields).each(function(){b[this.name]=c(this).val()}),this.xhr&&this.xhr.abort(),this.xhr=XF.ajax("get",this.options.acurl,b,XF.proxy(this,"showResults"),{global:!1,error:!1}))},hideResults:function(){this.results.hideResults()},showResults:function(a){this.xhr&&
(this.xhr=!1);this.options.jsonContainer&&a&&(a=a[this.options.jsonContainer]);this.results.showResults(this.getPartialValue(),a,this.$target)},addValue:function(a){if(this.options.single)this.$target.val(a);else{var b=this.getFullValues();""!=a&&(b.length&&(a=" "+a),b.push(a+this.options.multiple+" "));this.$target.val(b.join(this.options.multiple))}this.$target.trigger("auto-complete:insert",{inserted:a,current:this.$target.val()});this.options.autosubmit?this.$target.closest("form").submit():this.$target.autofocus()},
getFullValues:function(){var a=this.$target.val();if(""==a)return[];if(this.options.single)return[a];var b=a.lastIndexOf(this.options.multiple);if(-1==b)return[];a=a.substr(0,b);return a.split(this.options.multiple)},getPartialValue:function(){var a=this.$target.val();if(this.options.single)return c.trim(a);var b=a.lastIndexOf(this.options.multiple);return-1==b?c.trim(a):c.trim(a.substr(b+this.options.multiple.length))}});XF.UserMentioner=XF.Element.newHandler({options:{},$input:null,visible:!1,idleWait:200,
idleTimer:null,pendingMention:"",results:null,init:function(){this.$input=this.$target;var a=this;this.results=new XF.AutoCompleteResults({onInsert:function(b){a.insertMention(b)}});this.$input.on("keydown",XF.proxy(this,"keydown"));this.$input.on("keyup",XF.proxy(this,"keyup"));this.$input.on("blur click",XF.proxy(this,"blur"));c(e).on("scroll",XF.proxy(this,"blur"))},keydown:function(a){if(this.visible)switch(a.which){case 40:return this.results.selectResult(1),a.preventDefault(),!1;case 38:return this.results.selectResult(-1),
a.preventDefault(),!1;case 27:return this.hide(),a.preventDefault(),!1;case 13:if(this.visible)return a.preventDefault(),this.results.insertSelectedResult(),!1}},keyup:function(a){if(this.visible)switch(a.which){case 40:case 38:case 13:return}this.hide();this.idleTimer&&clearTimeout(this.idleTimer);this.idleTimer=setTimeout(XF.proxy(this,"lookForMention"),this.idleWait)},blur:function(){this.visible&&setTimeout(XF.proxy(this,"hide"),250)},lookForMention:function(){var a=this.getCurrentMentionInfo();
a?this.foundMention(a.name):this.hide()},getCurrentMentionInfo:function(){var a=this.$input;a.autofocus();var b=a.getSelection();if(!b||1>=b.end)return!1;a=a.val().substring(0,b.end);var c=a.lastIndexOf("@");if(-1==c)return null;if(0==c||a.substr(c-1,1).match(/(\s|[\](,]|--)/)){var d=a.substr(c+1);if(!d.match(/\s/)||10>=d.length)return{text:a,start:c,name:d.replace(new RegExp(String.fromCharCode(160),"g")," "),range:b}}return null},foundMention:function(a){this.pendingMention!=a&&(this.pendingMention=
a,2<=a.length&&"["!=a.substr(0,1)&&this.getPendingMentionOptions())},getPendingMentionOptions:function(){XF.ajax("GET",XF.getAutoCompleteUrl(),{q:this.pendingMention},XF.proxy(this,"handlePendingMentionOptions"),{global:!1,error:!1})},handlePendingMentionOptions:function(a){var b=this.getCurrentMentionInfo();a.q&&b&&a.q==b.name&&(a.results?this.show(a.q,a.results):this.hide())},insertMention:function(a){this.hide();var b=this.$input;b.autofocus();var c=this.getCurrentMentionInfo();if(c){var d=c.range;
-1!=c.start+1&&(b.setSelection(c.start,d.end),b.replaceSelectedText("@"+a+" ","collapseToEnd"))}},show:function(a,b){this.getCurrentMentionInfo()&&(this.visible=!0,this.results.showResults(a,b,this.$input))},hide:function(){this.visible&&(this.visible=!1,this.results.hideResults())}});XF.AutoSubmit=XF.Element.newHandler({options:{hide:!0,progress:!0},init:function(){this.$target.submit();this.options.hide&&this.$target.find(":submit").hide();this.options.progress&&c(e).trigger("xf:action-start")}});
XF.ChangedFieldNotifier=XF.Element.newHandler({options:{hide:!0,progress:!0},init:function(){this.$target.find("input, select, textarea").each(function(){var a=c(this);a.data("orig-val",a.val());a.change(function(){a.toggleClass("is-changed",a.val()!=a.data("orig-val"))})})}});XF.CheckAll=XF.Element.newHandler({options:{container:"< form",match:"input:checkbox"},$container:null,updating:!1,init:function(){this.$container=XF.findRelativeIf(this.options.container,this.$target);var a=this;this.$container.on("click",
this.options.match,function(b){a.updating||c(b.target).is(a.$target)||a.updateState()});this.updateState();this.$target.click(XF.proxy(this,"click"))},click:function(a){this.updating=!0;this.getCheckBoxes().prop("checked",a.target.checked).triggerHandler("click");this.updating=!1},updateState:function(){var a=this.getCheckBoxes(),b=0<a.length;a.each(function(){if(!c(this).prop("checked"))return b=!1});this.$target.prop("checked",b)},getCheckBoxes:function(){return this.$container.find(this.options.match).not(this.$target)}});
XF.DateInput=XF.Element.newHandler({options:{weekStart:0,minDate:null,maxDate:null,disableWeekends:!1,yearRange:null,showWeekNumber:!1,showDaysInNextAndPreviousMonths:!0},init:function(){var a=this.options.minDate,b=this.options.maxDate;if(a){var c=Date.parse(a.replace(/-/g,"/"));a=new Date(c)}b&&(c=Date.parse(b.replace(/-/g,"/")),b=new Date(c));var d=this,e=this.$target;c=e.val();a={onSelect:function(){var a=this._d,b=String(a.getDate()),c=String(a.getMonth()+1);a=String(a.getFullYear());d.$target.val(a+
"-"+(10>c?"0"+c:c)+"-"+(10>b?"0"+b:b))},onOpen:function(){e.prop("readonly")&&this.hide()},showTime:!1,firstDay:this.options.weekStart,minDate:a,maxDate:b,disableWeekends:this.options.disableWeekends,yearRange:this.options.yearRange,showWeekNumber:this.options.showWeekNumber,showDaysInNextAndPreviousMonths:this.options.showDaysInNextAndPreviousMonths,i18n:{previousMonth:"",nextMonth:"",weekdays:[0,1,2,3,4,5,6].map(function(a){return XF.phrase("day"+a)}),weekdaysShort:[0,1,2,3,4,5,6].map(function(a){return XF.phrase("dayShort"+
a)}),months:[0,1,2,3,4,5,6,7,8,9,10,11].map(function(a){return XF.phrase("month"+a)})},isRTL:XF.isRtl()};c&&(b=c.match(/^(\d{4})-(\d\d?)-(\d\d?)$/))&&(a.defaultDate=new Date(parseInt(b[1],10),parseInt(b[2],10)-1,parseInt(b[3])),a.setDefaultDate=!0);this.$target.pikaday(a);this.$target.val(c)}});XF.DescLoader=XF.Element.newHandler({options:{descUrl:null},$container:null,changeTimer:null,xhr:null,init:function(){if(this.options.descUrl){var a=this.$target.parent().find(".js-descTarget");a.length?(this.$container=
a,this.$target.on("change",XF.proxy(this,"change"))):console.error("Target element must have a .js-descTarget sibling")}else console.error("Element must have a data-desc-url value")},change:function(){this.changeTimer&&clearTimeout(this.changeTimer);this.xhr&&(this.xhr.abort(),this.xhr=null);this.changeTimer=setTimeout(XF.proxy(this,"onTimer"),200)},onTimer:function(){var a=this.$target.val();a?this.xhr=XF.ajax("post",this.options.descUrl,{id:a},XF.proxy(this,"onLoad")):this.$container.xfFadeUp(XF.config.speed.fast)},
onLoad:function(a){var b=this.$container;a.description?b.xfFadeUp(XF.config.speed.fast,function(){b.html(a.description);b.xfFadeDown(XF.config.speed.normal)}):b.xfFadeUp(XF.config.speed.fast);this.xhr=null}});XF.Disabler=XF.Element.newHandler({options:{container:"< li | ul, ol, dl",controls:"input, select, textarea, button, .js-attachmentUpload",hide:!1,optional:!1,invert:!1},$container:null,init:function(){this.$container=XF.findRelativeIf(this.options.container,this.$target);this.$container.length||
this.options.optional||console.error("Could not find the disabler control container");var a=this.$target,b=a.closest("form");if(b.length)b.on("reset",XF.proxy(this,"formReset"));if(a.is(":radio")){var f=b,d=a.attr("name");b.length||(f=c(e.body));f.on("click",'input:radio[name="'+d+'"]',XF.proxy(this,"click"))}else a.click(XF.proxy(this,"click"));a.on("control:enabled control:disabled",XF.proxy(this,"recalculateAfter"));this.recalculate(!0)},click:function(a,b){this.recalculateAfter(!1,b&&b.triggered)},
formReset:function(a){this.recalculateAfter(!1,!0)},recalculateAfter:function(a,b){var c=this;setTimeout(function(){c.recalculate(a,b)},0)},recalculate:function(a,b){var f=this.$container,d=this.$target,e=f.find(this.options.controls).not(d),g=a?0:XF.config.speed.fast,h=function(){b||f.find("input:not([type=hidden], [type=file]), textarea, select, button").not(d).first().autofocus()};d.is(":enabled")&&(d.is(":checked")&&!this.options.invert||this.options.invert&&!d.is(":checked"))?(f.prop("disabled",
!1).removeClass("is-disabled"),e.prop("disabled",!1).removeClass("is-disabled").each(function(a,b){a=c(b);a.is("select.is-readonly")&&a.prop("disabled",!0)}).trigger("control:enabled"),this.options.hide?(a?f.show():f.slideDown(g,function(){XF.layoutChange();h()}),XF.layoutChange()):a||h()):(this.options.hide&&(a?f.hide():f.slideUp(g,XF.layoutChange),XF.layoutChange()),f.prop("disabled",!0).addClass("is-disabled"),e.prop("disabled",!0).addClass("is-disabled").trigger("control:disabled").each(function(a,
b){a=c(b);b=a.data("disabled");null!==b&&"undefined"!=typeof b&&a.val(b)}))}});XF.FieldAdder=XF.Element.newHandler({options:{incrementFormat:null,remaining:-1},$clone:null,created:!1,init:function(){this.$target.find("input:not(:checkbox), select, textarea").val("");this.$clone=this.$target.clone();var a=this;this.$target.on("keypress change",function(b){c(b.target).prop("readonly")||(a.$target.off(b),a.create())})},create:function(){if(!this.created&&(this.created=!0,0!=this.options.remaining)){var a=
this.options.incrementFormat;if(this.options.incrementFormat){var b=new RegExp("^"+XF.regexQuote(a).replace("\\{counter\\}","(\\d+)"));this.$clone.find("input, select, textarea").each(function(){var f=c(this),d=f.attr("name");d=d.replace(b,function(b,c){return a.replace("{counter}",parseInt(c,10)+1)});f.attr("name",d)})}0<this.options.remaining&&this.$clone.attr("data-remaining",this.options.remaining-1);this.$clone.insertAfter(this.$target);XF.activate(this.$clone);XF.layoutChange()}}});XF.FormSubmitRow=
XF.Element.newHandler({options:{container:".block-container",fixedChild:".formSubmitRow-main",stickyClass:"is-sticky",topOffset:100,minWindowHeight:281},$container:null,$fixedParent:null,$fixEl:null,fixElHeight:0,winHeight:0,containerTop:0,containerBorderLeftWidth:0,topOffset:0,elBottom:0,state:"normal",windowTooSmall:!1,init:function(){if(XF.config.enableFormSubmitSticky){var a=this.$target,b=a.closest(this.options.container);b.length?(this.$container=b,this.topOffset=this.options.topOffset,this.$fixEl=
a.find(this.options.fixedChild),c(h).on("scroll",XF.proxy(this,"onScroll")).on("resize",XF.proxy(this,"recalcAndUpdate")),b=XF.getFixedOffsetParent(a),b.is("html")||(this.$fixedParent=b,b.on("scroll",XF.proxy(this,"onScroll"))),c(e.body).on("xf:layout",XF.proxy(this,"recalcAndUpdate")),a.height()||setTimeout(XF.proxy(this,"recalcAndUpdate"),250),this.recalcAndUpdate()):console.error("Cannot float submit row, no container")}},recalc:function(){var a=this.$target;this.winHeight=c(h).height();this.elBottom=
this.getTargetTop()+a.height();this.fixElHeight=this.$fixEl.height();this.containerTop=XF.getFixedOffset(this.$container).top;this.containerBorderLeftWidth=parseInt(this.$container.css("border-left-width"),10)},recalcAndUpdate:function(){this.state="normal";this.resetTarget();this.recalc();this.update()},getTargetTop:function(){var a=this.$target.offset().top;return this.$fixedParent?a-this.$fixedParent.offset().top:a},getScrollTop:function(){return this.$fixedParent?this.$fixedParent.scrollTop():
c(h).scrollTop()},update:function(){var a=XF.browser.ios||XF.browser.android?h.innerHeight:this.winHeight;if(a<this.options.minWindowHeight)"normal"!=this.state&&(this.resetTarget(),this.state="normal");else if(a=this.getScrollTop()+a,a>=this.elBottom)"normal"!=this.state&&(this.resetTarget(),this.state="normal");else{var b=this.containerTop+this.topOffset+this.fixElHeight;a<=b?b>=this.elBottom||"absolute"==this.state||(a=this.$container.offset(),"stuck"==this.state?(b=this.$fixEl.parent(),"static"==
b.css("position")&&(b=b.offsetParent())):b=this.$fixEl.offsetParent(),b=b.offset(),this.$fixEl.css({position:"absolute",top:a.top-b.top+this.topOffset,right:"auto",bottom:"auto",left:a.left-b.left+this.containerBorderLeftWidth,width:this.$container.width()}),this.setTargetSticky(!0),this.state="absolute"):"stuck"!=this.state&&(a=this.$container.offset(),this.$fixEl.css({position:"",top:"",right:"",bottom:"",left:a.left+this.containerBorderLeftWidth,width:this.$container.width()}),this.setTargetSticky(!0),
this.state="stuck")}},resetTarget:function(){this.$fixEl.css({position:"",top:"",right:"",bottom:"",left:"",width:""});this.setTargetSticky(!1)},setTargetSticky:function(a){this.$target.toggleClass("is-sticky",a).css("height",this.$fixEl.height())},onScroll:function(){this.update()}});XF.GuestUsername=XF.Element.newHandler({init:function(){var a=this.$target;a.val(XF.LocalStorage.get("guestUsername"));a.on("keyup",XF.proxy(this,"change"))},change:function(){var a=this.$target;a.val().length?XF.LocalStorage.set("guestUsername",
a.val(),!0):XF.LocalStorage.remove("guestUsername")}});XF.MinLength=XF.Element.newHandler({options:{minLength:0,allowEmpty:!1,disableSubmit:!0,toggleTarget:null},met:null,$form:null,$toggleTarget:null,init:function(){var a=this;this.$form=this.$target.closest("form");this.$toggleTarget=this.options.toggleTarget?XF.findRelativeIf(this.options.toggleTarget,this.$target):c([]);this.$target.on("change keypress keydown paste",function(){setTimeout(XF.proxy(a,"checkLimits"),0)});this.checkLimits()},checkLimits:function(){var a=
c.trim(this.$target.val()).length,b=this.options;a=a>=b.minLength||0==a&&b.allowEmpty;a!==this.met&&((this.met=a)?(b.disableSubmit&&this.$form.find(":submit").prop("disabled",!1).removeClass("is-disabled"),this.$toggleTarget.hide()):(b.disableSubmit&&this.$form.find(":submit").prop("disabled",!0).addClass("is-disabled"),this.$toggleTarget.show()))}});XF.TextAreaHandler=XF.Element.newHandler({options:{autoSize:!0,keySubmit:!0,singleLine:!1},initialized:!1,init:function(){this.options.autoSize&&(this.$target[0].scrollHeight?
this.setupAutoSize():(this.$target.one("focus",XF.proxy(this,"setupDelayed")),this.$target.onWithin("toggle:shown overlay:shown tab:shown quick-edit:shown",XF.proxy(this,"setupDelayed"))),this.$target.on("autosize",XF.proxy(this,"update")));if(this.options.keySubmit||this.options.singleLine)this.$target.on("keydown",XF.proxy(this,"keySubmit"))},setupAutoSize:function(){this.initialized||(this.initialized=!0,autosize(this.$target),this.$target.on("autosize:resized",function(){XF.layoutChange()}))},
setupDelayed:function(){if(this.initialized)this.update();else{var a=this,b=function(){a.setupAutoSize();XF.layoutChange()};this.$target[0].scrollHeight?b():setTimeout(b,100)}},update:function(){this.initialized?autosize.update(this.$target[0]):this.setupDelayed()},keySubmit:function(a){if(13==a.which&&(this.options.singleLine||this.options.keySubmit&&(XF.isMac()?a.metaKey:a.ctrlKey)))return a.preventDefault(),this.$target.closest("form").submit(),!1}});XF.PermissionMatrix=XF.Element.newHandler({options:{inputSelector:'input[type="radio"]',
parentSelector:"dl.formRow",classPrefix:"formRow--permissionType-",permissionType:"user"},values:["allow","unset","deny","content_allow","reset"],currentClass:null,init:function(){this.$parentRow=this.$target.closest(this.options.parentSelector);this.$target.find(this.options.inputSelector).on("click",XF.proxy(this,"update"));this.update()},update:function(){this.currentClass&&this.$parentRow.removeClass(this.currentClass);var a=this.$target.find(this.options.inputSelector+":checked").val();-1<c.inArray(a,
this.values)&&(this.currentClass=this.options.classPrefix+this.options.permissionType+"-"+a,this.$parentRow.addClass(this.currentClass))}});XF.MultiCheck=XF.Click.newHandler({eventNameSpace:"XFMultiCheck",options:{target:null,values:"allow,unset,deny"},$target:null,values:null,currentValue:null,init:function(){this.$target=c(this.options.target);this.values=this.options.values.split(",");var a=this.$target.filter(":checked").first().val();this.currentValue=0<c.inArray(a,this.values)?this.values[-1]:
this.values[0]},click:function(a){var b=this.values[c.inArray(this.currentValue,this.values)+1];void 0===b&&(b=this.values[0]);this.$target.each(function(){c(this).val()==b&&c(this).prop("checked",!0).trigger("click")});this.currentValue=b}});XF.NumberBox=XF.Element.newHandler({options:{textInput:".js-numberBoxTextInput"},$textInput:null,holdTimeout:null,holdInterval:null,init:function(){var a=this.$target,b=a.find(this.options.textInput);if(b.length){a.addClass("inputGroup--joined");var f=c("<button />").attr("type",
"button").attr("tabindex","-1").addClass("inputGroup-text").addClass("inputNumber-button").on("focus",XF.proxy(this,"buttonFocus")).on("click",XF.proxy(this,"buttonClick")).on("mousedown touchstart",XF.proxy(this,"buttonMouseDown")).on("mouseleave mouseup touchend",XF.proxy(this,"buttonMouseUp")).on("touchend",function(a){a.preventDefault();c(this).click()});a=f.clone(!0).data("dir","up").addClass("inputNumber-button--up").insertAfter(b);f=f.clone(!0).data("dir","down").addClass("inputNumber-button--down").insertAfter(a);
b.prop("disabled")&&(a.addClass("is-disabled").prop("disabled",!0),f.addClass("is-disabled").prop("disabled",!0));b.hasClass("input--numberNarrow")&&(a.addClass("inputNumber-button--smaller"),f.addClass("inputNumber-button--smaller"));this.$textInput=b;if(!this.supportsStepFunctions())b.on("keydown",XF.proxy(this,"stepFallback"))}else console.error("Cannot initialize, no text input.")},buttonFocus:function(a){return!1},buttonClick:function(a){this.step(c(a.target).data("dir"))},step:function(a){var b=
this.$textInput,c="step"+a.charAt(0).toUpperCase()+a.slice(1);if(!b.prop("readonly"))if(this.supportsStepFunctions())b[0][c]();else this.stepFallback(a)},stepFallback:function(a){if(!this.$textInput.prop("readonly")){if("object"===typeof a&&a.keyCode){var b=a;switch(b.keyCode){case 38:a="up";b.preventDefault();break;case 40:a="down";b.preventDefault();break;default:return}}b=this.$textInput;var c=b.val(),d="down"===a?-1:1;a=b.attr("min")||null;var e=b.attr("max")||null,g=b.attr("step")||1,h="any"==
g;h&&(g=1);g=parseFloat(g);d=parseFloat(c)+g*d;if(Math.round(d)!==d){var l=0;c=c.split(".");h?l=c[1]?c[1].length:0:Math.floor(g)!==g&&(l=g.toString().split(".")[1].length||0);d=d.toFixed(l)}null!==a&&d<a&&(d=a);null!==e&&d>e&&(d=e);isNaN(d)&&(d=0);b.val(d)}},buttonMouseDown:function(a){this.buttonMouseUp(a);this.holdTimeout=setTimeout(XF.proxy(function(){this.holdInterval=setInterval(XF.proxy(function(){this.step(c(a.target).data("dir"))},this),75)},this),500)},buttonMouseUp:function(a){clearTimeout(this.holdTimeout);
clearInterval(this.holdInterval)},supportsStepFunctions:function(){var a=this.$textInput.clone();if(!a.prop("disabled")&&!a.prop("readonly")){if("function"===typeof a[0].stepUp)try{a[0].stepUp()}catch(b){return!1}else return!1;return!0}}});XF.CheckboxSelectDisabler=XF.Element.newHandler({options:{select:null},$select:null,$checkboxes:null,init:function(){(this.$select=XF.findRelativeIf(this.options.select,this.$target))&&this.$select.length?(this.$checkboxes=this.$target.find(":checkbox").on("click",
XF.proxy(this,"update")),this.update()):console.warn("No select element found using %s",this.options.select)},update:function(){var a=this.$select;this.$checkboxes.each(function(){var b=a.find("option[value="+this.value+"]").prop("disabled",!this.checked);!this.checked&&b.is(":selected")&&a.find("option:enabled").first().prop("selected",!0)})}});XF.focusNext=function(a){!a instanceof c&&(a=c(a));var b=c("a, button, :input, [tabindex]");a=b.index(a)+1;b.eq(a>=b.length?0:a).focus()};XF.Click.register("submit",
"XF.SubmitClick");XF.Click.register("multi-check","XF.MultiCheck");XF.Element.register("ajax-submit","XF.AjaxSubmit");XF.Element.register("auto-complete","XF.AutoComplete");XF.Element.register("user-mentioner","XF.UserMentioner");XF.Element.register("auto-submit","XF.AutoSubmit");XF.Element.register("changed-field-notifier","XF.ChangedFieldNotifier");XF.Element.register("check-all","XF.CheckAll");XF.Element.register("date-input","XF.DateInput");XF.Element.register("desc-loader","XF.DescLoader");XF.Element.register("disabler",
"XF.Disabler");XF.Element.register("field-adder","XF.FieldAdder");XF.Element.register("form-submit-row","XF.FormSubmitRow");XF.Element.register("guest-username","XF.GuestUsername");XF.Element.register("min-length","XF.MinLength");XF.Element.register("textarea-handler","XF.TextAreaHandler");XF.Element.register("permission-matrix","XF.PermissionMatrix");XF.Element.register("number-box","XF.NumberBox");XF.Element.register("checkbox-select-disabler","XF.CheckboxSelectDisabler")}(jQuery,window,document);
